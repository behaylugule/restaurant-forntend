(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4700],{2107:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var s=r(5784);let a={registerUser:function(e){return s.A.post("/register/",e)},login:o,logout:p,getCurrentUser:n,changePassword:l,getUsers:c,forgetPassword:i,resetPassword:d,updateProfile:u};async function o(e){return await s.A.post("/token/",e)}async function n(){return await s.A.get("/me/")}async function l(e){return await s.A.put("/change-password/",e)}async function c(e){return await s.A.get("/users/",{params:{...e}})}async function i(e){return await s.A.post("/password-reset/",{email:e})}async function d(e){return await s.A.post("/password-reset/confirm/?token=".concat(e.token),e)}async function u(e){return await s.A.patch("/update-profile/".concat(e.id,"/"),e)}async function p(){localStorage.removeItem("access"),localStorage.removeItem("refresh"),window.location.href="/login"}},2302:(e,t,r)=>{Promise.resolve().then(r.bind(r,5761))},5761:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(5155),a=r(6766),o=r(6874),n=r.n(o),l=r(2177),c=r(2107),i=r(2115),d=r(3568),u=r(5695),p=r(9550);function m(){var e,t;let{register:r,handleSubmit:o,getValues:m,formState:{errors:h}}=(0,l.mN)(),[f,x]=(0,i.useState)(!1),{isAuthenticated:g}=(0,p.A)(),w=(0,u.useSearchParams)(),b=(0,u.useRouter)(),[y,v]=(0,i.useState)(!0),j=async e=>{var t;x(!0),c.D.resetPassword({token:(null==(t=w.get("token"))?void 0:t.toLocaleLowerCase())||"",password:e.password}).then(e=>{x(!1),d.Ay.success("Password Reset Success"),b.push("/login")}).catch(e=>{x(!1),d.Ay.error(e.message)})};return(0,i.useEffect)(()=>{g&&b.push("/login")},[g]),(0,s.jsx)("div",{className:"w-full h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900",children:(0,s.jsxs)("div",{className:" w-full lg:w-3/4 xl:w-1/2 lg:bg-white flex justify-between",children:[(0,s.jsxs)("div",{className:"flex-1 hidden lg:flex flex-col items-center justify-center py-12 px-10 bg-black rounded-r-4xl",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)(a.default,{className:"dark:invert",src:"/globe.svg",alt:"Vercel logomark",width:100,height:38}),(0,s.jsx)("h3",{className:"font-montserrat font-medium text-[23px] text-white text-center my-8 tracking-[12px]",children:"BookWarm"})]}),(0,s.jsxs)("span",{className:"text-[14px]  text-white my-8 font-light w-[250px] text-center",children:[" ","Your premier digital library for borrowing and reading books."]})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center gap-4 mb-8 py-12 px-10 relative",children:[(0,s.jsx)(a.default,{className:"dark:invert",src:"/globe.svg",alt:"Next.js logo",width:100,height:30,priority:!0}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("h3",{className:"font-montserrat font-medium text-[23px] text-gray-900 text-center dark:text-white my-8 tracking-[12px]",children:"Reset Password"}),(0,s.jsx)("span",{className:"w-full text-center mb-8 font-normal text-[14px] text-gray-700 dark:text-gray-300",children:"Please enter your new password"}),(0,s.jsxs)("form",{onSubmit:o(j),className:"w-full",children:[h.password&&(0,s.jsx)("span",{className:"text-red-500",children:null==(e=h.password)?void 0:e.message}),(0,s.jsx)("input",{type:"password",id:"password",...r("password",{required:"password is required"}),placeholder:"new password",className:"w-full h-10 px-4 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:border-blue-500"}),h.confirm_password&&(0,s.jsx)("span",{className:"text-red-500",children:null==(t=h.confirm_password)?void 0:t.message}),(0,s.jsx)("input",{type:"password",id:"confirm_password",...r("confirm_password",{required:"confirm password is required"}),placeholder:"confirm password",className:"w-full h-10 px-4 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:border-blue-500",onChange:e=>v(e.target.value==m("password"))}),y?"":(0,s.jsx)("span",{className:"text-red-600 text-sm",children:"password is not match"}),(0,s.jsx)("button",{type:"submit",disabled:!y,className:"w-full bg-black text-white text-center py-2 mt-5 font-medium rounded-lg hover:bg-black/80 transition-all duration-300 cursor-pointer",children:f?(0,s.jsx)("span",{className:"inline-block w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}):"Reset Password"})]}),(0,s.jsx)(n(),{href:"/login",className:" px-3 font-normal  text-center border border-black  text-black rounded-l-full transition-all duration-300 cursor-pointer absolute top-4 right-0",children:"BACK"})]})]})]})})}function h(){return(0,s.jsx)(i.Suspense,{children:(0,s.jsx)(m,{})})}},5784:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(3464),a=r(3568);let o="http://localhost:8000/api",n=s.A.create({baseURL:o});n.interceptors.request.use(e=>{console.log("base URL",o);{let t=localStorage.getItem("access");t&&(e.headers.Authorization="Bearer ".concat(t))}return"post"!==e.method&&"put"!==e.method&&"patch"!==e.method||e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json"),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t,r,n;let l=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!l._retry){l._retry=!0;try{localStorage.getItem("refresh");let e=await s.A.post(o+"/token/refresh");localStorage.setItem("access",e.data.access),l.headers.Authorization="Bearer ".concat(e.data.access)}catch(e){localStorage.removeItem("access"),localStorage.removeItem("refresh"),window.location.href="/login"}}return console.log("Error response:",e.response),a.Ay.error((null==(n=e.response)||null==(r=n.data)?void 0:r.message)||"An error occurred"),Promise.reject(e)});let l=n},9550:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>c});var s=r(5155),a=r(2115),o=r(2107),n=r(3568);let l=(0,a.createContext)(void 0),c=e=>{let{children:t}=e,[r,c]=(0,a.useState)(null),[i,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=localStorage.getItem("access");e&&(c(e),o.D.getCurrentUser().then(e=>{d(e.data.data)}).catch(e=>{console.error("Failed to fetch current user:",e),d(null)}))},[]),(0,s.jsx)(l.Provider,{value:{user:i,accessToken:r,isAuthenticated:!!r,login:e=>{c(e),o.D.getCurrentUser().then(e=>{d(e.data.data)}).catch(e=>{n.Ay.error("failed to fetch current user")})},logout:()=>{localStorage.removeItem("access"),c(null),d(null)}},children:t})},i=()=>{let e=(0,a.useContext)(l);if(void 0==e)throw Error("useAuth must be used within an Authprovider");return e}}},e=>{e.O(0,[7567,2177,7244,6766,8441,5964,7358],()=>e(e.s=2302)),_N_E=e.O()}]);