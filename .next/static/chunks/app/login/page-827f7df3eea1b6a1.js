(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{119:(e,t,r)=>{Promise.resolve().then(r.bind(r,8007))},2107:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var s=r(5784);let a={registerUser:function(e){return s.A.post("/register/",e)},login:n,logout:m,getCurrentUser:o,changePassword:l,getUsers:c,forgetPassword:i,resetPassword:u,updateProfile:d};async function n(e){return await s.A.post("/token/",e)}async function o(){return await s.A.get("/me/")}async function l(e){return await s.A.put("/change-password/",e)}async function c(e){return await s.A.get("/users/",{params:{...e}})}async function i(e){return await s.A.post("/password-reset/",{email:e})}async function u(e){return await s.A.post("/password-reset/confirm/?token=".concat(e.token),e)}async function d(e){return await s.A.patch("/update-profile/".concat(e.id,"/"),e)}async function m(){localStorage.removeItem("access"),localStorage.removeItem("refresh"),window.location.href="/login"}},5765:(e,t,r)=>{"use strict";r.d(t,{Hc:()=>o,Mx:()=>n,tX:()=>s,w8:()=>a});var s=function(e){return e.ADMIN="admin",e.ORGANIZATION_ADMIN="organization_admin",e.SHOP_ADMIN="shop_admin",e.CUSTOMER="customer",e.USER="user",e}({}),a=function(e){return e.PENDING="pending",e.PROCESSING="processing",e.READY="ready",e.COMPLETED="completed",e.CANCLED="cancled",e}({}),n=function(e){return e.USER="user",e.SYSTEM="system",e}({});let o="https://restaurantsaasmenuimage.s3.amazonaws.com"},5784:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(3464),a=r(3568);let n="http://localhost:8000/api",o=s.A.create({baseURL:n});o.interceptors.request.use(e=>{console.log("base URL",n);{let t=localStorage.getItem("access");t&&(e.headers.Authorization="Bearer ".concat(t))}return"post"!==e.method&&"put"!==e.method&&"patch"!==e.method||e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json"),e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,async e=>{var t,r,o;let l=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!l._retry){l._retry=!0;try{localStorage.getItem("refresh");let e=await s.A.post(n+"/token/refresh");localStorage.setItem("access",e.data.access),l.headers.Authorization="Bearer ".concat(e.data.access)}catch(e){localStorage.removeItem("access"),localStorage.removeItem("refresh"),window.location.href="/login"}}return console.log("Error response:",e.response),a.Ay.error((null==(o=e.response)||null==(r=o.data)?void 0:r.message)||"An error occurred"),Promise.reject(e)});let l=o},8007:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(5155),a=r(6766),n=r(6874),o=r.n(n),l=r(2177),c=r(2107),i=r(2115),u=r(9550),d=r(5695),m=r(5765);function h(){let{register:e,handleSubmit:t,formState:{errors:r}}=(0,l.mN)(),[n,h]=(0,i.useState)(!1),{login:p,isAuthenticated:f,user:g}=(0,u.A)(),x=(0,d.useRouter)();return(0,i.useEffect)(()=>{f&&((null==g?void 0:g.role)===m.tX.USER?x.push("/"):x.push("/dashboard"))},[f]),(0,s.jsx)("div",{className:"w-full h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900",children:(0,s.jsxs)("div",{className:"w-full lg:w-3/4 xl:w-1/2   bg-transparent lg:bg-white flex  justify-between  ",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center gap-4 mb-8 py-12 px-10",children:[(0,s.jsx)(a.default,{className:"dark:invert",src:"/globe.svg",alt:"Next.js logo",width:100,height:38,priority:!0}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("h3",{className:"font-montserrat font-medium text-[23px] text-gray-900 text-center dark:text-white my-8 tracking-[12px]",children:"Welcome Back"}),(0,s.jsx)("span",{className:"w-full text-center mb-8 font-normal text-[14px] text-gray-700 dark:text-gray-300",children:"please enter your credientials to log in"}),(0,s.jsxs)("form",{onSubmit:t(e=>{h(!0),c.D.login({username:e.username,password:e.password||""}).then(e=>{localStorage.setItem("access",e.data.data.access),localStorage.setItem("refresh",e.data.data.refresh),p(e.data.data.access),h(!1)}).catch(e=>{h(!1)})}),className:"w-full",children:[(0,s.jsx)("input",{type:"text",...e("username",{required:"Username Required"}),placeholder:"Username",className:"w-full h-10 px-4 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:border-blue-500 "}),r.username&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:r.username.message}),(0,s.jsx)("input",{type:"password",...e("password",{required:"Password Required"}),placeholder:"Password",className:"w-full h-10 px-4 border border-gray-300 rounded-lg mb-2 focus:outline-none focus:border-blue-500"}),r.password&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:r.password.message}),(0,s.jsx)(o(),{className:"self-start text-[14px] text-gray-700 ",href:"/forgetpassword",children:"Forgot password?"}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-black text-white text-center py-2 mt-5 font-medium rounded-lg hover:bg-gray-600 transition-all duration-300 cursor-pointer",children:n?(0,s.jsx)("span",{className:"inline-block w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}):"Sign In"}),(0,s.jsxs)(o(),{href:"/register",className:"block lg:hidden self-start text-[14px] text-gray-700 mt-2",children:["You do not have account"," ",(0,s.jsx)("span",{className:"font-medium",children:"Sign Up"})," here"]})]})]})]}),(0,s.jsxs)("div",{className:"flex-1 hidden lg:flex flex-col items-center justify-center  py-12 px-10 bg-black rounded-l-4xl ",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)(a.default,{className:"dark:invert",src:"/globe.svg",alt:"Vercel logomark",width:100,height:38}),(0,s.jsx)("h3",{className:"font-montserrat font-medium text-[23px] text-white text-center my-8 tracking-[12px]",children:"BookWarm"})]}),(0,s.jsxs)("span",{className:"text-[14px] text-white my-8 font-normal",children:[" ","New to our platform? Sign Up now."]}),(0,s.jsx)(o(),{href:"/register",className:"py-2 px-16 text-center border border-white text-white rounded-lg hover:bg-gray-600  transition-all duration-300 cursor-pointer",children:"Sign Up"})]})]})})}},9550:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>c});var s=r(5155),a=r(2115),n=r(2107),o=r(3568);let l=(0,a.createContext)(void 0),c=e=>{let{children:t}=e,[r,c]=(0,a.useState)(null),[i,u]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=localStorage.getItem("access");e&&(c(e),n.D.getCurrentUser().then(e=>{u(e.data.data)}).catch(e=>{console.error("Failed to fetch current user:",e),u(null)}))},[]),(0,s.jsx)(l.Provider,{value:{user:i,accessToken:r,isAuthenticated:!!r,login:e=>{c(e),n.D.getCurrentUser().then(e=>{u(e.data.data)}).catch(e=>{o.Ay.error("failed to fetch current user")})},logout:()=>{localStorage.removeItem("access"),c(null),u(null)}},children:t})},i=()=>{let e=(0,a.useContext)(l);if(void 0==e)throw Error("useAuth must be used within an Authprovider");return e}}},e=>{e.O(0,[7567,2177,7244,6766,8441,5964,7358],()=>e(e.s=119)),_N_E=e.O()}]);