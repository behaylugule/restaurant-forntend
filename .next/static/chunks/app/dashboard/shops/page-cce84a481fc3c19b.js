(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[20],{495:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var r=n(5784);let s={getShops:a,getShop:l,addShop:i,updateShop:o,deleteShop:c,getShopsForClient:d};async function a(e){return await r.A.get("/shops/",{params:{...e}})}async function l(e){return await r.A.get("/shops/".concat(e,"/"))}async function i(e){return await r.A.post("/shops/",e)}async function o(e){return await r.A.patch("/shops/".concat(e.id,"/"),e)}async function c(e){return await r.A.delete("/shops/".concat(e,"/"))}async function d(e){let{page:t,page_size:n,search:s}=e;return await r.A.get("/client/shops/",{params:{page:t,page_size:n,search:s}})}},668:(e,t,n)=>{Promise.resolve().then(n.bind(n,5099))},3717:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(0,n(9946).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},3828:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var r=n(5784);let s={uploadFile:a};async function a(e){return await r.A.post("/upload/",e,{headers:{"Content-Type":"multipart/form-data"}})}},5099:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>F});var r=n(5155),s=n(9550),a=n(2115),l=n(5695),i=n(8524),o=n(5623),c=n(6839),d=n(3717),u=n(495),h=n(8698),f=n(7133),p=n(823),x=n(7168),m=n(9840),g=n(9540),j=n(2177),v=n(9852),b=n(3568),y=n(3828);let N=(0,a.createContext)(null);function S(){let e=(0,a.use)(N);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var w=n(5752),A=n.n(w);let C=(0,a.forwardRef)(function({bounds:e,boundsOptions:t,center:n,children:r,className:s,id:l,placeholder:i,style:o,whenReady:c,zoom:d,...u},h){let[f]=(0,a.useState)({className:s,id:l,style:o}),[p,x]=(0,a.useState)(null),m=(0,a.useRef)(void 0);(0,a.useImperativeHandle)(h,()=>p?.map??null,[p]);let g=(0,a.useCallback)(r=>{if(null!==r&&!m.current){let s=new w.Map(r,u);m.current=s,null!=n&&null!=d?s.setView(n,d):null!=e&&s.fitBounds(e,t),null!=c&&s.whenReady(c),x(Object.freeze({__version:1,map:s}))}},[]);(0,a.useEffect)(()=>()=>{p?.map.remove()},[p]);let j=p?a.createElement(N,{value:p},r):i??null;return a.createElement("div",{...f,ref:g},j)});function k(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function z(e,t){return null==t?function(t,n){let r=(0,a.useRef)(void 0);return r.current||(r.current=e(t,n)),r}:function(n,r){let s=(0,a.useRef)(void 0);s.current||(s.current=e(n,r));let l=(0,a.useRef)(n),{instance:i}=s.current;return(0,a.useEffect)(function(){l.current!==n&&(t(i,n,l.current),l.current=n)},[i,n,t]),s}}function R(e,t){let n=e.pane??t.pane;return n?{...e,pane:n}:e}function I(e){return function(t){var n;let r=S(),s=e(R(t,r),r);return!function(e,t){let n=(0,a.useRef)(t);(0,a.useEffect)(function(){t!==n.current&&null!=e.attributionControl&&(null!=n.current&&e.attributionControl.removeAttribution(n.current),null!=t&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}(r.map,t.attribution),!function(e,t){let n=(0,a.useRef)(void 0);(0,a.useEffect)(function(){return null!=t&&e.instance.on(t),n.current=t,function(){null!=n.current&&e.instance.off(n.current),n.current=null}},[e,t])}(s.current,t.eventHandlers),n=s.current,(0,a.useEffect)(function(){return(r.layerContainer??r.map).addLayer(n.instance),function(){r.layerContainer?.removeLayer(n.instance),r.map.removeLayer(n.instance)}},[r,n]),s}}n(7650);let E=function(e,t){var n;return n=I(z(e,t)),(0,a.forwardRef)(function(e,t){let{instance:r}=n(e).current;return(0,a.useImperativeHandle)(t,()=>r),null})}(function({url:e,...t},n){return k(new w.TileLayer(e,R(t,n)),n)},function(e,t,n){let{opacity:r,zIndex:s}=t;null!=r&&r!==n.opacity&&e.setOpacity(r),null!=s&&s!==n.zIndex&&e.setZIndex(s);let{url:a}=t;null!=a&&a!==n.url&&e.setUrl(a)}),O=function(e,t){var n;return n=I(z(e,t)),(0,a.forwardRef)(function(e,t){let{instance:r,context:s}=n(e).current;(0,a.useImperativeHandle)(t,()=>r);let{children:l}=e;return null==l?null:a.createElement(N,{value:s},l)})}(function({position:e,...t},n){var r;let s=new w.Marker(e,t);return k(s,(r={overlayContainer:s},Object.freeze({...n,...r})))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}),M=e=>{let{onSelect:t}=e;return!function(e){let t=S().map;(0,a.useEffect)(function(){return t.on(e),function(){t.off(e)}},[t,e])}({click(e){t(e.latlng.lat,e.latlng.lng)}}),null};function P(e){let{value:t,onChange:n}=e,{position:s,handleMapClick:l}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[9.03,38.74],[t,n]=(0,a.useState)(e);return{position:t,setPosition:n,handleMapClick:(e,t)=>{n([e,t])}}}(t||[9.03,38.74]);return(0,r.jsxs)(C,{center:s,zoom:13,style:{height:"400px",width:"100%"},children:[(0,r.jsx)(E,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,r.jsx)(M,{onSelect:(e,t)=>{l(e,t),n([e,t])}}),(0,r.jsx)(O,{position:s,icon:A().icon({iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41]})})]})}function _(e){var t,n;let{setOpen:l,getshops:i,actionType:o,shopDetail:c}=e,d=(0,j.mN)({defaultValues:{...c}}),[h,f]=(0,a.useState)(!1),{user:p}=(0,s.A)(),[m,N]=(0,a.useState)(""),[S,w]=(0,a.useState)([0,0]),A=e=>{w(e)};return(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(g.lV,{...d,children:(0,r.jsxs)("form",{onSubmit:d.handleSubmit(e=>{e.lat=S[0],e.lng=S[1],""!=m&&(e.shop_logo=m),"add"===o?(e.organization=p.organization,e.shop_logo=m,f(!0),u.S.addShop(e).then(()=>{b.Ay.success("Book has been created sucessfuly"),f(!1),l(!1),i()}).catch(e=>{f(!1),console.log(e)})):"edit"===o&&u.S.updateShop(e).then(()=>{b.Ay.success("Book has been updated sucessfuly"),f(!1),l(!1),i()}).catch(e=>{console.log(e)})}),children:[(0,r.jsxs)(g.eI,{className:"",children:[(0,r.jsx)(g.lR,{children:"name"}),(0,r.jsx)(g.MJ,{children:(0,r.jsx)(v.p,{placeholder:"name",...d.register("name",{required:"name is required field"})})}),d.formState.errors.name&&(0,r.jsx)(g.Rr,{className:"text-red text-sm",children:d.formState.errors.name.message}),(0,r.jsx)(g.C5,{})]}),(0,r.jsxs)(g.eI,{className:"mt-4",children:[(0,r.jsx)(g.lR,{children:"description"}),(0,r.jsx)(g.MJ,{children:(0,r.jsx)(v.p,{placeholder:"description",...d.register("description",{required:"description is required field"})})}),d.formState.errors.description&&(0,r.jsx)(g.Rr,{className:"text-red text-sm",children:null==(t=d.formState.errors.description)?void 0:t.message})]}),(0,r.jsxs)(g.eI,{className:"mt-4",children:[(0,r.jsx)(g.lR,{children:"address"}),(0,r.jsx)(g.MJ,{children:(0,r.jsx)(v.p,{placeholder:"address",...d.register("address",{required:"address is required field"})})}),d.formState.errors.address&&(0,r.jsx)(g.Rr,{className:"text-red text-sm",children:null==(n=d.formState.errors.address)?void 0:n.message})]}),(0,r.jsxs)(g.eI,{className:"mt-4",children:[(0,r.jsx)(g.lR,{children:" Location"}),(0,r.jsx)(j.xI,{name:"location",control:d.control,render:e=>{let{field:t}=e;return(0,r.jsx)(P,{value:t.value,onChange:A})}})]}),(0,r.jsxs)(g.eI,{className:"mt-4 mb-4",children:[(0,r.jsx)(g.lR,{children:"Logo"}),(0,r.jsx)(g.MJ,{children:(0,r.jsx)(v.p,{placeholder:"shop logo",type:"file",onChange:e=>{if(e.target.files){if(!e.target.files[0])return;let t=new FormData;t.append("file",e.target.files[0]),t.append("title",e.target.files[0].name),y.Y.uploadFile(t).then(e=>{N(e.data.data.id)}).catch(e=>{console.log(e)})}}})})]}),(0,r.jsx)(x.$,{type:"submit",className:"mt-4 hover:bg-gray-600",children:h?(0,r.jsx)("span",{className:"inline-block w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}):"edit"==o?"Update Shop":"Add Shop"})]})})})}var L=n(6037),q=n(5411),H=n(405),U=n(854),D=n(1412);function F(){let{isAuthenticated:e}=(0,s.A)(),t=(0,l.useRouter)(),[n,g]=(0,a.useState)([]),[j,v]=(0,a.useState)(!1),[y,N]=(0,a.useState)(!1),[S,w]=(0,a.useState)("add"),[A,C]=(0,a.useState)(),k=(0,H.W)(),[z,R]=(0,a.useState)();(0,a.useEffect)(()=>{e||t.push("/login")},[e]),(0,a.useEffect)(()=>{I()},[k.page,z]);let I=()=>{u.S.getShops({page:k.page,page_size:k.pageSize,...z}).then(e=>{v(!1),g(e.data.data.results),k.setTotalCount(e.data.data.count)}).catch(e=>{v(!1),console.log(e)})},E=async e=>{v(!0),u.S.deleteShop(e).then(t=>{v(!1),g(t=>t.filter(t=>(null==t?void 0:t.id)!==e))}).catch(e=>{v(!1),console.log(e)})};return(0,a.useEffect)(()=>{y||(C({id:"",name:"",description:"",shop_logo:"",organization:""}),w("add"))},[y]),(0,r.jsxs)("div",{className:"w-full px-2 lg:px-12",children:[(0,r.jsxs)("div",{className:"flex justify-between bg-white items-center  py-4 my-5",children:[(0,r.jsx)("div",{className:"flex-6/7",children:(0,r.jsx)(U.A,{config:[{label:"search",name:"search",type:"text"}],generateReport:()=>{D.N.generateShopReport({...z}).then(e=>{b.Ay.success(e.data.data.message)}).catch(e=>{console.log(e)})},onFilterChange:e=>{R({...e})}})}),(0,r.jsx)("div",{className:"flex-1/7",children:(0,r.jsxs)(m.lG,{open:y,onOpenChange:N,children:[(0,r.jsx)(m.zM,{className:"bg-black hover:bg-gray-500 cursor-pointer text-white px-4 py-2 rounded-lg shadow-lg",children:"Add Shop"}),(0,r.jsxs)(m.Cf,{children:[(0,r.jsx)(m.c7,{children:(0,r.jsx)(m.L3,{children:"Add Shop"})}),(0,r.jsx)(L.w,{}),(0,r.jsx)(_,{setOpen:N,getshops:I,actionType:S,shopDetail:A})]})]})})]}),(0,r.jsxs)("div",{className:"flex flex-col justify-center ",children:[(0,r.jsxs)(i.XI,{className:"bg-white",children:[(0,r.jsx)(i.A0,{children:(0,r.jsxs)(i.Hj,{children:[(0,r.jsx)(i.nd,{children:"ID"}),(0,r.jsx)(i.nd,{children:"Name"}),(0,r.jsx)(i.nd,{children:"Code"}),(0,r.jsx)(i.nd,{children:"Description"}),(0,r.jsx)(i.nd,{children:"Address"}),(0,r.jsx)(i.nd,{children:"Action"})]})}),(0,r.jsx)(i.BF,{children:!j&&n.map((e,t)=>(0,r.jsxs)(i.Hj,{children:[(0,r.jsx)(i.nA,{children:null==e?void 0:e.id}),(0,r.jsx)(i.nA,{children:null==e?void 0:e.name}),(0,r.jsx)(i.nA,{children:null==e?void 0:e.code}),(0,r.jsx)(i.nA,{children:null==e?void 0:e.description}),(0,r.jsx)(i.nA,{children:null==e?void 0:e.address}),(0,r.jsx)(i.nA,{children:(0,r.jsxs)(h.rI,{children:[(0,r.jsx)(f.ty,{children:(0,r.jsx)(o.A,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsxs)(f.SQ,{className:"w-18",children:[(0,r.jsx)(f.lp,{className:"flex items-center text-gray-700 cursor-pointer",children:(0,r.jsxs)(p.AM,{children:[(0,r.jsxs)(p.Wv,{className:"flex items-center text-gray-700 cursor-pointer",children:[(0,r.jsx)(c.A,{className:"mr-4 text-[12px]"}),"Delete"]}),(0,r.jsxs)(p.hl,{className:"w-64",children:["are you sure to delete this shop?",(0,r.jsxs)("div",{className:"flex justify-center mt-4",children:[(0,r.jsx)(x.$,{className:"text-red-600 bg-transparent outline-red-600",children:"No"}),(0,r.jsx)(x.$,{className:"text-green-600 bg-transparent outline-green-600",onClick:()=>E(e.id),children:"Yes"})]})]})]})}),(0,r.jsxs)(f.lp,{className:"flex item-center text-gray-700 cursor-pointer",onClick:()=>{C(e),w("edit"),N(!0)},children:[(0,r.jsx)(d.A,{className:"mr-4 text-[12px]"}),"Update"]})]})]})})]},t))})]}),(0,r.jsx)(q.dK,{className:"self-start",children:(0,r.jsxs)(q.Iu,{children:[(0,r.jsx)(q.cU,{onClick:j?void 0:k.handlePrevPage,children:(0,r.jsx)(q.Eb,{})}),k.totalCount>0&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(q.cU,{children:(0,r.jsxs)(q.n$,{children:["Total:",k.totalCount]})})}),(0,r.jsx)(q.cU,{onClick:j?void 0:k.handleNextPage,className:0===n.length?"pointer-events-none opacity-50 ":"",children:(0,r.jsx)(q.WA,{})})]})})]})]})}},5695:(e,t,n)=>{"use strict";var r=n(8999);n.o(r,"useParams")&&n.d(t,{useParams:function(){return r.useParams}}),n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},6037:(e,t,n)=>{"use strict";n.d(t,{w:()=>l});var r=n(5155);n(2115);var s=n(7489),a=n(3999);function l(e){let{className:t,orientation:n="horizontal",decorative:l=!0,...i}=e;return(0,r.jsx)(s.b,{"data-slot":"separator",decorative:l,orientation:n,className:(0,a.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...i})}},6839:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(0,n(9946).A)("delete",[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]])},7489:(e,t,n)=>{"use strict";n.d(t,{b:()=>c});var r=n(2115),s=n(3655),a=n(5155),l="horizontal",i=["horizontal","vertical"],o=r.forwardRef((e,t)=>{var n;let{decorative:r,orientation:o=l,...c}=e,d=(n=o,i.includes(n))?o:l;return(0,a.jsx)(s.sG.div,{"data-orientation":d,...r?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...c,ref:t})});o.displayName="Separator";var c=o},9852:(e,t,n)=>{"use strict";n.d(t,{p:()=>a});var r=n(5155);n(2115);var s=n(3999);function a(e){let{className:t,type:n,...a}=e;return(0,r.jsx)("input",{type:n,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...a})}}},e=>{e.O(0,[1761,7567,397,2177,2128,8795,9196,8345,8467,9857,5715,8441,5964,7358],()=>e(e.s=668)),_N_E=e.O()}]);